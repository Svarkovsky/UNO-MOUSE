#include <TVout.h>
#include <font6x8.h> // Використовуємо шрифт 6x8 для тексту

TVout TV;

// --- Дані для простого бітмапу (наприклад, маленький квадрат) ---
// Формат: ширина (байт), висота (байт), дані пікселів...
// Дані пікселів: кожен байт представляє 8 пікселів по горизонталі.
// 8x8 пікселів = 8 байт даних
PROGMEM const unsigned char myBitmap[] = {
  8, 8, // Ширина (8 пікселів = 1 байт), Висота (8 рядків)
  0b11111111, // Рядок 0
  0b10000001, // Рядок 1
  0b10111101, // Рядок 2
  0b10100101, // Рядок 3
  0b10100101, // Рядок 4
  0b10111101, // Рядок 5
  0b10000001, // Рядок 6
  0b11111111  // Рядок 7
};

void setup() {
  // Ініціалізація TVout.
  // Використовуємо NTSC, роздільна здатність 128x96.
  // Якщо у вас PAL телевізор, замініть NTSC на PAL.
  // Роздільну здатність можна змінити, але пам'ятайте про обмеження SRAM.
  TV.begin(NTSC, 128, 96);
  // TV.begin(PAL, 128, 96); // Для PAL регіону

  // Вибираємо шрифт для виведення тексту
  TV.select_font(font6x8);

  // Початкове очищення екрана
  TV.clear_screen();
}

void loop() {

  // --- Демо 1: Базові фігури ---
  TV.clear_screen(); // Очистити екран (заповнити чорним)
  TV.print(0, 0, "Demo 1: Shapes"); // Вивести текст в позиції (0,0)

  // Малюємо точку
  TV.set_pixel(10, 20, WHITE); // Малюємо білу точку в (10, 20)

  // Малюємо лінії
  TV.draw_line(20, 20, 60, 30, WHITE); // Лінія з (20,20) до (60,30) білим
  TV.draw_line(20, 30, 60, 20, WHITE); // Лінія з (20,30) до (60,20) білим

  // Малюємо прямокутники
  TV.draw_rect(70, 20, 30, 20, WHITE); // Незаповнений прямокутник (x,y,ширина,висота,колір)
  TV.draw_rect(110, 20, 15, 15, WHITE, WHITE); // Заповнений прямокутник (x,y,ширина,висота,колір рамки,колір заповнення)

  // Малюємо кола
  TV.draw_circle(40, 60, 15, WHITE); // Незаповнене коло (x,y,радіус,колір)
  TV.draw_circle(90, 60, 15, WHITE, WHITE); // Заповнене коло (x,y,радіус,колір рамки,колір заповнення)

  TV.delay_frame(120); // Затримка на 120 кадрів (приблизно 2 секунди при 60 Гц)

  // --- Демо 2: Текст ---
  TV.clear_screen();
  TV.print(0, 0, "Demo 2: Text");

  // Використання println для переходу на новий рядок
  TV.println("Line 1");
  TV.println("Line 2");
  TV.println("Line 3");

  // Встановлення курсора та виведення тексту
  TV.set_cursor(0, 50); // Встановити курсор в позицію (0, 50)
  TV.print("Cursor at (0,50)");

  // Виведення чисел
  TV.set_cursor(0, 60);
  TV.print("Value: ");
  TV.print(12345); // Виведе число 12345
  TV.print(" Hex: ");
  TV.print(255, HEX); // Виведе число 255 в шістнадцятковому форматі (FF)

  TV.delay_frame(120);

  // --- Демо 3: Бітмап ---
  TV.clear_screen();
  TV.print(0, 0, "Demo 3: Bitmap");

  // Малюємо бітмап
  // bitmap(x, y, дані_бітмапу)
  // Ширина та висота зчитуються з перших двох байтів масиву myBitmap
  TV.bitmap(50, 30, myBitmap);

  TV.delay_frame(120);

  // --- Демо 4: Зсув екрана ---
  TV.clear_screen();
  TV.print(0, 0, "Demo 4: Shift");

  // Намалюємо щось, щоб було видно зсув
  TV.draw_rect(20, 20, 80, 50, WHITE, WHITE); // Заповнений прямокутник

  TV.delay_frame(60); // Затримка перед початком зсуву

  // Зсуваємо вправо на 8 пікселів (1 байт)
  TV.shift(1, RIGHT);
  TV.delay_frame(30); // Коротка затримка між зсувами

  // Зсуваємо вниз на 8 пікселів
  TV.shift(8, DOWN);
  TV.delay_frame(30);

  // Зсуваємо вліво на 8 пікселів (1 байт)
  TV.shift(1, LEFT);
  TV.delay_frame(30);

  // Зсуваємо вгору на 8 пікселів
  TV.shift(8, UP);
  TV.delay_frame(60); // Затримка після зсуву

  // --- Демо 5: Звук (Тон) ---
  TV.clear_screen();
  TV.print(0, 0, "Demo 5: Tone");
  TV.print(0, 10, "Connect speaker to D11 & GND");

  // Граємо тон (частота, тривалість в мс)
  TV.tone(440, 500); // Нота Ля (A4) на 500 мс
  TV.delay(600); // Затримка трохи довша за тон

  TV.tone(880, 500); // Нота Ля (A5) на 500 мс
  TV.delay(600);

  TV.noTone(); // Зупинити тон

  TV.delay_frame(120);

  // --- Кінець демо, цикл почнеться знову ---
}
